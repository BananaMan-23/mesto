(()=>{"use strict";class e{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}disableSubmitButton(){this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disbaled=!0}_activeError(e,t){const s=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),s.classList.add(this._errorClass),s.textContent=t}_inactiveError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._inactiveError(e):this._activeError(e,e.validationMessage)}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_toggleButtonState(e,t){this._hasInvalidInput(e)?this.disableSubmitButton():(t.classList.remove(this._inactiveButtonClass),t.disabled=!1)}_setIventListeners(){this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._toggleButtonState(this._inputList,this._buttonElement),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState(this._inputList,this._buttonElement)}))}))}enableValidation(){this._setIventListeners()}}class t{constructor(e,t){let{data:s,handleCardClick:n}=e;this._name=s.name,this._link=s.link,this._handleCardClick=n,this._cardSelector=t}_getTemplate(){this._card=document.querySelector(this._cardSelector).content.querySelector(".element").cloneNode(!0)}renderCard(){return this._getTemplate(),this._setEventListeners(),this._img.alt=this._name,this._img.src=this._link,this._card.querySelector(".element__group-subtitle").textContent=this._name,this._card}_setEventListeners(){this._img=this._card.querySelector(".element__image"),this._like=this._card.querySelector(".element__group-like"),this._like.addEventListener("click",(()=>{this._handleLikeCard()})),this._card.querySelector(".element__trash").addEventListener("click",(()=>{this._handleRemoveCard()})),this._img.addEventListener("click",(()=>{this._handleCardClick({name:this._name,link:this._link})}))}_handleLikeCard(){this._like.classList.toggle("element__group-like_active")}_handleRemoveCard(){this._card.remove()}}class s{constructor(e){this._popup=document.querySelector(e),this._handleEscClosed=this._handleEscClose.bind(this)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClosed)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClosed)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup_opened")||e.target.classList.contains("popup__close"))&&this.close()}))}}class n extends s{constructor(e,t){super(e),this._submitCallback=t,this._popupForm=this._popup.querySelector(".popup__form"),this._inputList=this._popupForm.querySelectorAll(".popup__input")}_getInputValues(){return this._newValues={},this._inputList.forEach((e=>{this._newValues[e.name]=e.value})),this._newValues}close(){super.close(),this._popupForm.reset()}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._submitCallback(this._getInputValues())}))}}const i=document.querySelector(".profile__container-edit"),r=document.querySelector("#name-input"),o=document.querySelector("#info-input"),l=document.querySelector(".profile__container-title"),a=document.querySelector(".profile__container-subtitle"),p=document.querySelector(".profile__container-add"),c=(document.querySelector(".popup__input_place_name"),document.querySelector(".popup__input_place_url"),document.querySelector("form[name='popup_adding']")),u=document.querySelector("form[name='popup_profile']"),_=e=>{const s=new t({data:e,handleCardClick:e=>{h.open(e)}},".template-cards");d.addItem(s.renderCard())},d=new class{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._renderer=n,this._container=document.querySelector(t)}render(){this._items.reverse().forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>{_(e)}},".elements");d.render();const h=new class extends s{constructor(e){super(e),this._popupImage=this._popup.querySelector(".popup__image"),this._popupCaption=this._popup.querySelector(".popup__caption")}open(e){super.open(),this._popupImage.src=e.link,this._popupImage.alt=e.name,this._popupCaption.textContent=e.name}}(".popup_zoom-image");h.setEventListeners();const m=new n(".popup_card-add",(e=>{_(e),m.close()}));m.setEventListeners();const v=new class{constructor(e){let{inputNameSelector:t,inputJobSelector:s}=e;this._profileName=document.querySelector(t),this._profileJob=document.querySelector(s)}getUserInfo(){return this._user={inputName:this._profileName.textContent,inputJob:this._profileJob.textContent},this._user}setUserInfo(e,t){this._profileName.textContent=e,this._profileJob.textContent=t}}({inputNameSelector:".profile__container-title",inputJobSelector:".profile__container-subtitle"}),S=new n(".popup_open-edit",(e=>{v.setUserInfo(e.name,e.info),S.close()}));S.setEventListeners(),i.addEventListener("click",(function(){y.disableSubmitButton(),v.getUserInfo(),r.value=l.textContent,o.value=a.textContent,S.open()})),p.addEventListener("click",(e=>{E.disableSubmitButton(),m.open()}));const C={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"},y=new e(C,u);y.enableValidation();const E=new e(C,c);E.enableValidation()})();